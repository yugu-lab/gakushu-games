<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ц╝вхнЧуБЩуБФуВНуБПуВ▓уГ╝уГа</title>
  <style>
    body {
      font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #1e3c72 100%);
      margin: 0;
      padding: 10px;
      min-height: 100vh;
      overflow-x: hidden;
      animation: backgroundShift 15s ease-in-out infinite;
    }
    @keyframes backgroundShift {
      0%, 100% { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #1e3c72 100%); }
      33% { background: linear-gradient(135deg, #2c3e50 0%, #34495e 50%, #2c3e50 100%); }
      66% { background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); }
    }

    .game-container {
      max-width: 100%;
      margin: 0 auto;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      height: calc(100vh - 20px);
      display: flex;
      flex-direction: column;
      border: 2px solid #3498db;
    }

    .title {
      text-align: center;
      color: #3498db;
      font-size: 2rem;
      margin-bottom: 15px;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
      font-weight: bold;
      animation: titleGlow 2s ease-in-out infinite alternate;
    }
    @keyframes titleGlow {
      0% { text-shadow: 3px 3px 6px rgba(0,0,0,0.5), 0 0 20px rgba(52, 152, 219, 0.3); }
      100% { text-shadow: 3px 3px 6px rgba(0,0,0,0.5), 0 0 30px rgba(52, 152, 219, 0.6); }
    }

    .game-board {
      display: grid;
      grid-template-columns: repeat(10, 1fr);
      grid-template-rows: repeat(3, 1fr);
      gap: 8px;
      margin: 10px 0;
      padding: 15px;
      background: linear-gradient(45deg, #34495e, #2c3e50);
      border-radius: 15px;
      border: 3px solid #3498db;
      box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
      height: 220px;
      overflow: visible;
      position: relative;
    }

    .cell {
      aspect-ratio: 1;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      height: auto;
      align-self: start; /* хЕишзТуВ╣уГЪуГ╝уВ╣уВТщЩдхО╗уБЧуБжцнгх╕╕хМЦ */
      font-weight: bold;
      position: relative;
      transition: all 0.3s ease;
      font-size: 0.8rem;
      min-height: 30px;
    }
    .cell:hover { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

    .start { background: #4CAF50; color: white; }
    .goal { background: #FF6B6B; color: white; }

    .color1 { background: #FF9999; color: white; }
    .color2 { background: #99CCFF; color: white; }
    .color3 { background: #99FF99; color: white; }
    .color4 { background: #FFCC99; color: white; }
    .color5 { background: #FF99FF; color: white; }
    .color6 { background: #99FFFF; color: white; }
    .color7 { background: #FFFF99; color: #333; }
    .color8 { background: #CC99FF; color: white; }
    .color9 { background: #FFB366; color: white; }
    .color10 { background: #66FFB3; color: white; }

    .player {
      position: absolute;
      font-size: 2rem;
      z-index: 10;
      animation: bounce 0.5s ease;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      filter: drop-shadow(0 0 8px rgba(255,255,255,0.8));
    }
    @keyframes bounce {
      0%, 100% { transform: translateY(0) scale(1); }
      50% { transform: translateY(-8px) scale(1.1); }
    }
    .player1 { top: -8px; left: 2px; }
    .player2 { bottom: -8px; right: 2px; }

    .game-info {
      display: grid;
      grid-template-columns: 1fr auto 1fr;
      gap: 15px;
      margin: 10px 0;
      flex-shrink: 0;
      align-items: center;
    }

    .player-info {
      background: linear-gradient(135deg, #34495e, #2c3e50);
      color: #ecf0f1;
      padding: 10px;
      border-radius: 15px;
      text-align: center;
      font-size: 0.75rem;
      border: 2px solid #7f8c8d;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    .player-info.active {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      transform: scale(1.05);
      box-shadow: 0 10px 30px rgba(52, 152, 219, 0.6);
      border-color: #3498db;
      animation: activeGlow 2s ease-in-out infinite alternate;
    }
    @keyframes activeGlow {
      0% { box-shadow: 0 10px 30px rgba(52, 152, 219, 0.6); }
      100% { box-shadow: 0 15px 40px rgba(52, 152, 219, 0.8); }
    }

    .controls { text-align: center; margin: 10px 0; flex-shrink: 0; }
    .dice-container { display: inline-block; margin: 10px; }

    .dice {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #ffd93d, #ffb347);
      border: 3px solid #ff6b6b;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      font-weight: bold;
      margin: 0 auto 8px;
      transition: transform 0.5s ease;
      box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
      color: #333;
    }
    .dice.rolling { animation: roll 1s ease-in-out; }
    @keyframes roll {
      0% { transform: rotate(0deg); }
      25% { transform: rotate(90deg); }
      50% { transform: rotate(180deg); }
      75% { transform: rotate(270deg); }
      100% { transform: rotate(360deg); }
    }

    .btn {
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 5px;
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      border: 1px solid #2980b9;
    }
    .btn:hover { transform: translateY(-3px) scale(1.05); box-shadow: 0 15px 25px rgba(52, 152, 219, 0.5); background: linear-gradient(135deg, #2980b9, #1f4e79); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

    .question-modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      display: none; align-items: center; justify-content: center;
      z-index: 1000;
    }
    .question-content { background: white; padding: 40px; border-radius: 20px; text-align: center; max-width: 500px; width: 90%; }
    .question-text { font-size: 1.5rem; margin-bottom: 30px; color: #333; }
    .answer-input {
      width: 100%; padding: 15px; font-size: 1.2rem;
      border: 2px solid #3498db; border-radius: 10px; margin: 20px 0; text-align: center;
      background: #ecf0f1; color: #2c3e50;
    }
    .answer-input:focus { outline: none; border-color: #2980b9; box-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }
    .submit-answer {
      background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; border: none; padding: 12px 30px;
      border-radius: 25px; font-size: 1rem; cursor: pointer; transition: all 0.3s ease; margin: 10px;
      box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
    }
    .submit-answer:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(39, 174, 96, 0.4); }

    .cards-section { margin-top: 10px; text-align: center; flex-shrink: 0; }
    .cards-display {
      display: flex; justify-content: center; gap: 8px; margin: 10px 0; flex-wrap: wrap;
      max-height: 80px; overflow-y: auto;
    }
    .card {
      background: linear-gradient(135deg, #ffd93d, #ff6b6b); color: white; padding: 15px; border-radius: 10px;
      font-weight: bold; min-width: 120px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
    .player-cards { margin-top: 10px; display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; }
    .mini-card {
      background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 5px 8px; border-radius: 5px;
      font-size: 0.8rem; cursor: pointer; transition: transform 0.2s ease;
    }
    .mini-card:hover { transform: scale(1.1); }

    .card-modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 1500;
    }
    .card-menu { background: white; padding: 30px; border-radius: 20px; text-align: center; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; }
    .card-list { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
    .card-item {
      background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px; border-radius: 10px;
      cursor: pointer; transition: all 0.3s ease;
    }
    .card-item:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.3); }
    .card-description { font-size: 0.9rem; margin-top: 5px; opacity: 0.9; }

    .winner-modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 2000;
    }
    .winner-content { background: white; padding: 50px; border-radius: 20px; text-align: center; animation: celebration 1s ease-in-out; }
    @keyframes celebration {
      0% { transform: scale(0.5) rotate(-180deg); opacity: 0; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    .card-popup {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 3000;
    }
    .card-popup-content {
      background: linear-gradient(135deg, #ffd93d, #ff6b6b); color: white; padding: 40px; border-radius: 20px; text-align: center;
      max-width: 400px; width: 90%; animation: cardAppear 0.8s ease-out; box-shadow: 0 20px 40px rgba(0,0,0,0.3);
    }
    @keyframes cardAppear {
      0% { transform: scale(0) rotate(180deg); opacity: 0; }
      50% { transform: scale(1.2) rotate(0deg); opacity: 0.8; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    .card-popup h2 { margin: 0 0 20px 0; font-size: 2rem; }
    .card-popup .card-name { font-size: 1.5rem; margin: 15px 0; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
    .card-popup .card-desc { font-size: 1.1rem; margin: 15px 0; opacity: 0.9; }

    /* уГвуГ╝уВ╖уГзуГ│х╝▒уВБшинхоЪхп╛х┐Ь */
    @media (prefers-reduced-motion: reduce) {
      * { animation: none !important; transition: none !important; }
    }

    .setup-screen, .instructions-screen {
      position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
      display: flex; align-items: center; justify-content: center; z-index: 1000;
    }
    .setup-container, .instructions-container {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      border-radius: 20px; padding: 40px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      border: 2px solid #3498db; max-width: 500px; width: 90%; text-align: center;
    }
    .setup-form { display: flex; flex-direction: column; gap: 20px; }
    .input-group { text-align: left; }
    .input-group label { display: block; color: #ecf0f1; margin-bottom: 8px; font-weight: bold; }
    .name-input, .grade-select {
      width: 100%; padding: 12px; border: 2px solid #3498db; border-radius: 10px; font-size: 1rem;
      background: #ecf0f1; color: #2c3e50;
    }
    .name-input:focus, .grade-select:focus { outline: none; border-color: #2980b9; box-shadow: 0 0 10px rgba(52, 152, 219, 0.3); }

    .instructions-content { color: #ecf0f1; text-align: left; line-height: 1.6; }
    .instructions-content h3 { color: #3498db; margin-top: 25px; margin-bottom: 10px; }
    .instructions-content ol, .instructions-content ul { padding-left: 20px; }
    .instructions-content li { margin-bottom: 8px; }

    .roulette-chip{
      background: linear-gradient(135deg,#f1c40f,#f39c12);
      color:#2c3e50; padding:12px 16px; border-radius:12px;
      min-width:180px; text-align:center; border:2px solid #e67e22;
      box-shadow:0 8px 20px rgba(0,0,0,0.2); font-weight:bold;
      transition:transform .15s ease, box-shadow .15s ease;
    }
    .roulette-chip.active{ transform: scale(1.08); box-shadow:0 12px 26px rgba(230,126,34,.45); border-color:#e74c3c; }
  </style>
</head>
<body>
  <!-- хИЭцЬЯшинхоЪчФ╗щЭв -->
  <div class="setup-screen" id="setupScreen">
    <div class="setup-container">
      <h1 class="title">ЁЯОп ц╝вхнЧуБЩуБФуВНуБПуВ▓уГ╝уГа ЁЯОп</h1>
      <div class="setup-form">
        <div class="input-group">
          <label>уГЧуГмуВдф║║цХ░уВТщБ╕цКЮуБЧуБжуБПуБауБХуБД</label>
          <select id="playerCountSelect" class="grade-select" onchange="togglePlayer2Input()">
            <option value="1">1ф║║уГЧуГмуВдя╝Иvs уВ│уГ│уГФуГеуГ╝уВ┐уГ╝я╝Й</option>
            <option value="2">2ф║║уГЧуГмуВд</option>
          </select>
        </div>
        <div class="input-group">
          <label>уГЧуГмуВдуГдуГ╝1уБохРНхЙН</label>
          <input type="text" id="player1Name" value="уГЧуГмуВдуГдуГ╝1" class="name-input" onfocus="this.select()">
        </div>
        <div class="input-group" id="player2Group">
          <label>уГЧуГмуВдуГдуГ╝2уБохРНхЙН</label>
          <input type="text" id="player2Name" value="уГЧуГмуВдуГдуГ╝2" class="name-input" onfocus="this.select()">
        </div>
        <div class="input-group">
          <label>щЫгцШУх║жуВТщБ╕цКЮуБЧуБжуБПуБауБХуБД</label>
          <select id="gradeSelect" class="grade-select">
            <option value="4">х░Пхнжцаб4х╣┤чФЯ</option>
            <option value="5">х░Пхнжцаб5х╣┤чФЯ</option>
            <option value="6">х░Пхнжцаб6х╣┤чФЯ</option>
          </select>
        </div>
        <button class="btn setup-btn" onclick="showInstructions()">цмбуБ╕</button>
      </div>
    </div>
  </div>

  <!-- уВ▓уГ╝уГашкмцШОчФ╗щЭв -->
  <div class="instructions-screen" id="instructionsScreen" style="display: none;">
    <div class="instructions-container">
      <h1 class="title">ЁЯОо уВ▓уГ╝уГауБошкмцШО ЁЯОо</h1>
      <div class="instructions-content">
        <h3>ЁЯОп уВ▓уГ╝уГауБочЫоциЩ</h3>
        <p>30уГЮуВ╣уБоSхнЧхЮЛуВ│уГ╝уВ╣уВТщА▓уВУуБзуАБцЬАхИЭуБлуВ┤уГ╝уГлуБлхИ░щБФуБЧуБЯуГЧуГмуВдуГдуГ╝уБохЛЭхИйуБзуБЩя╝Б</p>
        <h3>ЁЯО▓ уВ▓уГ╝уГауБоц╡БуВМ</h3>
        <ol>
          <li>уВ╡уВдуВ│уГнуВТцМпуБгуБжхЗ║уБЯчЫоуБоцХ░уБауБСщА▓уВБуБ╛уБЩ</li>
          <li>ц╝вхнЧуБохХПщбМуБМхЗ║щбМуБХуВМуБ╛уБЩ</li>
          <li>цнгшзгуБЩуВЛуБищА▓уВАуБУуБиуБМуБзуБНуАБуВлуГ╝уГЙуБМуВВуВЙуБИуВЛуБУуБиуБМуБВуВКуБ╛уБЩ</li>
          <li>ф╕НцнгшзгуБоха┤хРИуБпщА▓уВБуБ╛уБЫуВУ</li>
        </ol>
        <h3>ЁЯГП уВлуГ╝уГЙуБлуБдуБДуБж</h3>
        <p>уВлуГ╝уГЙуБлуБпцзШуАЕуБкхК╣цЮЬуБМуБВуВКуБ╛уБЩя╝Ъ</p>
        <ul>
          <li>ЁЯО▓ уВ╡уВдуВ│уГнч│╗я╝ЪуВИуВКхдЪуБПщА▓уВБуВЛ</li>
          <li>ЁЯТе цФ╗цТГч│╗я╝ЪчЫ╕цЙЛуВТхжихо│уБЩуВЛ</li>
          <li>ЁЯЫбя╕П щШ▓х╛бч│╗я╝ЪцФ╗цТГуБЛуВЙш║луВТхоИуВЛ</li>
          <li>ЁЯЪА чз╗хЛХч│╗я╝ЪчЙ╣хИеуБкчз╗хЛХуБМуБзуБНуВЛ</li>
        </ul>
        <button class="btn start-btn" onclick="startGame()">уВ▓уГ╝уГащЦЛхзЛя╝Б</button>
      </div>
    </div>
  </div>

  <div class="game-container" id="gameContainer" style="display: none;">
    <h1 class="title">ЁЯОп ц╝вхнЧуБЩуБФуВНуБПуВ▓уГ╝уГа ЁЯОп</h1>

    <div class="game-board" id="gameBoard"></div>

    <div class="game-info">
      <div class="player-info active" id="player1Info">
        <div style="display: flex; justify-content: space-between; align-items: center;">
          <div style="flex: 1;">
            <div style="display: flex; align-items: center; gap: 10px;">
              <h4 style="margin: 0; font-size: 0.9rem;" id="player1NameDisplay">ЁЯСж уГЧуГмуВдуГдуГ╝1</h4>
              <button class="btn" id="useCardBtn1" onclick="showCardMenu(1)" style="display: none; font-size: 0.6rem; padding: 4px 8px;">уВлуГ╝уГЙф╜┐чФи</button>
            </div>
            <div class="player-cards" id="player1CardsList"></div>
          </div>
        </div>
      </div>

      <div class="dice-container" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
        <div id="diceArea" style="display: flex; gap: 5px; flex-wrap: wrap; justify-content: center;">
          <div class="dice" id="dice">?</div>
        </div>
        <button class="btn" id="rollBtn" onclick="rollDice()" style="font-size: 1rem; padding: 12px 24px; margin: 8px;">уВ╡уВдуВ│уГн</button>
        <button class="btn" onclick="showQuitConfirm()" style="font-size: 0.7rem; padding: 6px 12px; background: linear-gradient(135deg, #e74c3c, #c0392b); margin-top: 15px;">уВ▓уГ╝уГач╡Вф║Ж</button>
      </div>

      <div class="player-info" id="player2Info">
        <div style="flex: 1;">
          <div style="display: flex; align-items: center; gap: 10px;">
            <h4 style="margin: 0; font-size: 0.9rem;" id="player2NameDisplay">ЁЯСз уГЧуГмуВдуГдуГ╝2</h4>
            <button class="btn" id="useCardBtn2" onclick="showCardMenu(2)" style="display: none; font-size: 0.6rem; padding: 4px 8px;">уВлуГ╝уГЙф╜┐чФи</button>
          </div>
          <div class="player-cards" id="player2CardsList"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- хХПщбМуГвуГ╝уГАуГл -->
  <div class="question-modal" id="questionModal">
    <div class="question-content">
      <h3>ц╝вхнЧхХПщбМ</h3>
      <div class="question-text" id="questionText"></div>
      <input type="text" class="answer-input" id="answerInput" placeholder="уБ▓уВЙуБМуБкуБзчнФуБИуВТхЕехКЫуБЧуБжуБПуБауБХуБД" onkeypress="if(event.key==='Enter') submitAnswer()">
      <button class="submit-answer" onclick="submitAnswer()">хЫЮчнФуБЩуВЛ</button>
    </div>
  </div>

  <!-- уВлуГ╝уГЙуГбуГЛуГеуГ╝уГвуГ╝уГАуГл -->
  <div class="card-modal" id="cardModal">
    <div class="card-menu">
      <h3>уВлуГ╝уГЙуВТщБ╕цКЮуБЧуБжуБПуБауБХуБД</h3>
      <div class="card-list" id="cardList"></div>
      <button class="btn" onclick="closeCardMenu()">уВнуГгуГ│уВ╗уГл</button>
    </div>
  </div>

  <!-- уВлуГ╝уГЙчН▓х╛ЧуГЭуГГуГЧуВвуГГуГЧ -->
  <div class="card-popup" id="cardPopup">
    <div class="card-popup-content">
      <h2>ЁЯОЙ уВлуГ╝уГЙчН▓х╛Чя╝Б ЁЯОЙ</h2>
      <div class="card-name" id="popupCardName"></div>
      <div class="card-desc" id="popupCardDesc"></div>
      <button class="btn" onclick="closeCardPopup()">OK</button>
    </div>
  </div>

  <!-- уВ╖уГ╝уГлуГЙчЩ║хЛХуГЭуГГуГЧуВвуГГуГЧ -->
  <div class="card-popup" id="shieldPopup">
    <div class="card-popup-content" style="background: linear-gradient(135deg, #3498db, #2980b9);">
      <h2>ЁЯЫбя╕П уВ╖уГ╝уГлуГЙчЩ║хЛХя╝Б ЁЯЫбя╕П</h2>
      <div class="card-name">цФ╗цТГуВТщШ▓уБОуБ╛уБЧуБЯя╝Б</div>
      <button class="btn" onclick="closeShieldPopup()">OK</button>
    </div>
  </div>

  <!-- цнгшзгуГ╗ф╕НцнгшзгуГЭуГГуГЧуВвуГГуГЧ -->
  <div class="card-popup" id="answerPopup">
    <div class="card-popup-content" id="answerPopupContent">
      <h2 id="answerResultTitle">ЁЯОЙ цнгшзгя╝Б ЁЯОЙ</h2>
      <div class="card-name" id="answerResultMessage"></div>
      <button class="btn" onclick="closeAnswerPopup()">OK</button>
    </div>
  </div>

  <!-- уВлуГ╝уГЙф╜┐чФиуГЭуГГуГЧуВвуГГуГЧ -->
  <div class="card-popup" id="cardUsePopup">
    <div class="card-popup-content" style="background: linear-gradient(135deg, #9b59b6, #8e44ad);">
      <h2>ЁЯГП уВлуГ╝уГЙф╜┐чФия╝Б ЁЯГП</h2>
      <div class="card-name" id="usedCardName"></div>
      <div class="card-desc" id="usedCardDesc"></div>
      <button class="btn" onclick="closeCardUsePopup()">OK</button>
    </div>
  </div>

  <!-- хЛЭхИйуГвуГ╝уГАуГл -->
  <div class="winner-modal" id="winnerModal">
    <div class="winner-content">
      <h2 id="winnerText"></h2>
      <p>ЁЯОЙ уБКуВБуБзуБиуБЖуБФуБЦуБДуБ╛уБЩя╝Б ЁЯОЙ</p>
      <button class="btn" onclick="resetGame()">уВВуБЖф╕Ах║жщБКуБ╢</button>
    </div>
  </div>

  <!-- уВ▓уГ╝уГач╡Вф║Жчв║шкНуГвуГ╝уГАуГл -->
  <div class="winner-modal" id="quitModal">
    <div class="winner-content">
      <h2>ЁЯЪк уВ▓уГ╝уГач╡Вф║Ж</h2>
      <p>цЬмх╜УуБлуВ▓уГ╝уГауВТуВДуВБуБ╛уБЩуБЛя╝Я</p>
      <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
        <button class="btn" onclick="quitGame()" style="background: linear-gradient(135deg, #e74c3c, #c0392b);">уБпуБД</button>
        <button class="btn" onclick="closeQuitConfirm()">уБДуБДуБИ</button>
      </div>
    </div>
  </div>

  <!-- хЕИшбМуГлуГ╝уГмуГГуГИ -->
  <div class="winner-modal" id="firstPlayerModal" style="display:none;">
    <div class="winner-content" style="max-width:520px;">
      <h2>ЁЯО░ хЕИшбМуГЧуГмуВдуГдуГ╝уВТц▒║уВБуБ╛уБЩ</h2>
      <div id="rouletteArea" style="display:flex; gap:16px; justify-content:center; margin:20px 0;">
        <div id="rouletteP1" class="roulette-chip">ЁЯСж <span id="rouletteP1Name">уГЧуГмуВдуГдуГ╝1</span></div>
        <div id="rouletteP2" class="roulette-chip">ЁЯСз <span id="rouletteP2Name">уГЧуГмуВдуГдуГ╝2</span></div>
      </div>
      <div id="rouletteMsg" style="margin:10px 0 20px; font-weight:bold;"></div>
      <button class="btn" id="rouletteStartBtn" onclick="startFirstPlayerRoulette()">уВ╣уВ┐уГ╝уГИ</button>
      <button class="btn" id="rouletteProceedBtn" style="display:none;" onclick="proceedAfterRoulette()">уБУуБощаЖуБзщЦЛхзЛ</button>
    </div>
  </div>

  <script>
    // хЕехКЫцнгшжПхМЦщЦвцХ░я╝ИхнРуБйуВВуБохЕехКЫуВЖуВЙуБОхп╛х┐Ья╝Й
    function toHiragana(input){
      // хЕишзТхМЦуГ╗х░ПцЫ╕уБНч╡▒ф╕АуГ╗уВлуВ┐уВлуГКтЖТуБ▓уВЙуБМуБкуГ╗щХ╖щЯ│хЗжчРЖуГ╗чй║чЩ╜щЩдхО╗
      let s = input.normalize('NFKC').toLowerCase().trim();
      // уВлуВ┐уВлуГКтЖТуБ▓уВЙуБМуБк
      s = s.replace(/[\u30A1-\u30F6]/g, ch => String.fromCharCode(ch.charCodeAt(0) - 0x60));
      // щХ╖щЯ│уАМуГ╝уАНуВТчЫ┤хЙНцпНщЯ│уБлх▒ХщЦЛя╝ИуБКуБКуБЦуБгуБ▒уБауБМхоЯчФичЪДя╝Й
      s = s.replace(/([уБВуБДуБЖуБИуБК])уГ╝/g, '$1$1');
      // х░ПцЫ╕уБНч╡▒ф╕А
      const map = {'уББ':'уБВ','уБГ':'уБД','уБЕ':'уБЖ','уБЗ':'уБИ','уБЙ':'уБК','уВГ':'уВД','уВЕ':'уВЖ','уВЗ':'уВИ','уБг':'уБд','уВО':'уВП'};
      s = s.replace(/[уББуБГуБЕуБЗуБЙуВГуВЕуВЗуБгуВО]/g, m => map[m] || m);
      // чй║чЩ╜уГ╗хПешкнчВ╣уБощЩдхО╗
      s = s.replace(/[\sуАБуАВя╝ОуГ╗я╜е]/g,'');
      return s;
    }
    const normalize = toHiragana;

    // уВ▓уГ╝уГачК╢цЕЛ
    let currentPlayer = 1;
    let players = {
      1: { position: 0, cards: [], shields: 0, skipTurn: false, name: "" },
      2: { position: 0, cards: [], shields: 0, skipTurn: false, name: "" }
    };
    let diceValue = 0;
    let gameEnded = false;
    let selectedGrade = 4;
    let currentQuestion = null;
    let isAIGame = false;
    let playerCount = 2;
    let turnLocked = false; // хЕехКЫуГнуГГуВп
    let pendingAnswerFor = null; // хЫЮчнФуБоцЙАцЬЙшАЕ
    let lucky6Active = false; // уГйуГГуВнуГ╝6
    let aiBusy = false; // AIхЖНхЕещШ▓цнв
    const timers = []; // уВ┐уВдуГЮуГ╝чобчРЖ
    let isClosingCardPopup = false;
    let isSwitchingTurn = false;
    let lastAnswerCorrect = null;
    let turnId = 0;

    // уГлуГ╝уГмуГГуГИщЦвщАг
    let rouletteInterval = null;
    let rouletteSpins = 0;
    let rouletteDecided = null;

    // хнжх╣┤хИец╝вхнЧхХПщбМуГЗуГ╝уВ┐
    const questionsByGrade = {
      4: [ /* чЬБчХеуБкуБЧя╝ЪхЕГуГЗуГ╝уВ┐уБЭуБоуБ╛уБ╛ */ 
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхНФхКЫуАН", answer: "уБНуВЗуБЖуВКуВЗуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхп╛ш▒буАН", answer: "уБЯуБДуБЧуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╡РцЮЬуАН", answer: "уБСуБгуБЛ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшкмцХЩуАН", answer: "уБЫуБгуБНуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчДбхоЯуАН", answer: "уВАуБШуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщаЖф╜НуАН", answer: "уБШуВЕуВУуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшбгщбЮуАН", answer: "уБДуВЛуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшжБц▒ВуАН", answer: "уВИуБЖуБНуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхКачЖ▒уАН", answer: "уБЛуБнуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЦвщАгуАН", answer: "уБЛуВУуВМуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхоЯщиУуАН", answer: "уБШуБгуБСуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЩВх╖оуАН", answer: "уБШуБХ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЩпхУБуАН", answer: "уБСуБДуБ▓уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх┐╡щбШуАН", answer: "уБнуВУуБМуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЕ╡хглуАН", answer: "уБ╕уБДуБЧ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхМЧце╡уАН", answer: "уБ╗уБгуБНуВЗуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщМ▓щЯ│уАН", answer: "уВНуБПуБКуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЬАш┐СуАН", answer: "уБХуБДуБНуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщБФф║║уАН", answer: "уБЯуБдуБШуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЖЖхСиуАН", answer: "уБИуВУуБЧуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцмаха┤уАН", answer: "уБСуБдуБШуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЭСц░СуАН", answer: "уБЭуВУуБ┐уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЗ║х╕нуАН", answer: "уБЧуВЕуБгуБЫуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщБац╡ЕуАН", answer: "уБиуБКуБВуБХ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхпЯчЯеуАН", answer: "уБХуБгуБб" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщАЪф┐буАН", answer: "уБдуБЖуБЧуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЕещЪКуАН", answer: "уБлуВЕуБЖуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчиощбЮуАН", answer: "уБЧуВЕуВЛуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч▓ЙцЬлуАН", answer: "уБ╡уВУуБ╛уБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╣┤ш╝куАН", answer: "уБнуВУуВКуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц░┤ф╜НуАН", answer: "уБЩуБДуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЬкхоЪуАН", answer: "уБ┐уБжуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхКахЕеуАН", answer: "уБЛуБлуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцоЛцЪСуАН", answer: "уБЦуВУуБЧуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх░ПхМЕуАН", answer: "уБУуБеуБдуБ┐" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц║АчВ╣уАН", answer: "уБ╛уВУуБжуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╜УчД╢уАН", answer: "уБиуБЖуБЬуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЦвф┐ВуАН", answer: "уБЛуВУуБСуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцбИхЖЕуАН", answer: "уБВуВУуБкуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЮЛч┤ЩуАН", answer: "уБЛуБЯуБМуБ┐" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЭвчйНуАН", answer: "уВБуВУуБЫуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш┐╜хКауАН", answer: "уБдуБДуБЛ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╣┤цЬлуАН", answer: "уБнуВУуБ╛уБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЬицЭРуАН", answer: "уВВуБПуБЦуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЫ╜ц░СуАН", answer: "уБУуБПуБ┐уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц│Хф║ЛуАН", answer: "уБ╗уБЖуБШ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЕ╡хЩиуАН", answer: "уБ╕уБДуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф┐бхП╖уАН", answer: "уБЧуВУуБФуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхАЙх║луАН", answer: "уБЭуБЖуБУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЕ╡щЪКуАН", answer: "уБ╕уБДуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц░ЧхАЩуАН", answer: "уБНуБУуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЬнцЭЯуАН", answer: "уБХуБдуБЯуБ░" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╛ТцнйуАН", answer: "уБиуБ╗" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщМ▓чФ╗уАН", answer: "уВНуБПуБМ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхдзшЗгуАН", answer: "уБауБДуБШуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╝Ъш▓╗уАН", answer: "уБЛуБДуБ▓" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЦ╣ц│ХуАН", answer: "уБ╗уБЖуБ╗уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЕ▒чФиуАН", answer: "уБНуВЗуБЖуВИуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцйЯцв░уАН", answer: "уБНуБЛуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшж│ховуАН", answer: "уБЛуВУуБНуВГуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцДЫчКмуАН", answer: "уБВуБДуБСуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхС╜ф╗дуАН", answer: "уВБуБДуВМуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчеЭчжПуАН", answer: "уБЧуВЕуБПуБ╡уБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМце╜хЩиуАН", answer: "уБМуБгуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшЙпшЦмуАН", answer: "уВКуВЗуБЖуВДуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш╗НцЙЛуАН", answer: "уБРуВУуБж" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╡РцЭЯуАН", answer: "уБСуБгуБЭуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщАгч╢ЪуАН", answer: "уВМуВУуБЮуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхРНцЬнуАН", answer: "уБкуБ╡уБа" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцФ╛ч╜оуАН", answer: "уБ╗уБЖуБб" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЦЗшДИуАН", answer: "уБ╢уВУуБ┐уВГуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхдлф║║уАН", answer: "уБ╡уБШуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЖ╖щЭЩуАН", answer: "уВМуБДуБЫуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщБФцИРуАН", answer: "уБЯуБгуБЫуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╝Ъшн░уАН", answer: "уБЛуБДуБО" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшжБчВ╣уАН", answer: "уВИуБЖуБжуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЫ╜чФгуАН", answer: "уБУуБПуБХуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцКХчеиуАН", answer: "уБиуБЖуБ▓уВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╢ИхН░уАН", answer: "уБСуБЧуБДуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЩ║щБФуАН", answer: "уБпуБгуБЯуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЗНшжБуАН", answer: "уБШуВЕуБЖуВИуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЫохН░уАН", answer: "уВБуБШуВЛуБЧ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╛ЧчВ╣уАН", answer: "уБиуБПуБжуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш╗НщЪКуАН", answer: "уБРуВУуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╕Ец╡БуАН", answer: "уБЫуБДуВКуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╛ЧцДПуАН", answer: "уБиуБПуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╡┤ходуАН", answer: "уВИуБПуБЧуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх▒▒шДИуАН", answer: "уБХуВУуБ┐уВГуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщбШцЬЫуАН", answer: "уБМуВУуБ╝уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхСиш╛║уАН", answer: "уБЧуВЕуБЖуБ╕уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЗ║ш▓╗уАН", answer: "уБЧуВЕуБгуБ┤" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЫоциЩуАН", answer: "уВВуБПуБ▓уВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф┐бчФиуАН", answer: "уБЧуВУуВИуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшж│хпЯуАН", answer: "уБЛуВУуБХуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш╛ЮцЫ╕уАН", answer: "уБШуБЧуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╕нщаЖуАН", answer: "уБЫуБНуБШуВЕуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчФЯчФгуАН", answer: "уБЫуБДуБХуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхбйхо│уАН", answer: "уБИуВУуБМуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщгЫшбМуАН", answer: "уБ▓уБУуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхдзщЩ╕уАН", answer: "уБЯуБДуВКуБП" }
      ],
      5: [
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш╝╕щАБуАН", answer: "уВЖуБЭуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцГЕчЖ▒уАН", answer: "уБШуВЗуБЖуБнуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЫЮх╛йуАН", answer: "уБЛуБДуБ╡уБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╢▓ф╜УуАН", answer: "уБИуБНуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч┐ТцЕгуАН", answer: "уБЧуВЕуБЖуБЛуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМца╝хоЙуАН", answer: "уБЛуБПуВДуБЩ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчжБчЙйуАН", answer: "уБНуВУуВВуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЛмчЙ╣уАН", answer: "уБйуБПуБиуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш│ЫцИРуАН", answer: "уБХуВУуБЫуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхо╢ш▓буАН", answer: "уБЛуБЦуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхПНхЙЗуАН", answer: "уБпуВУуБЭуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчв║хоЪуАН", answer: "уБЛуБПуБжуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчКпшбМуАН", answer: "уБпуВУуБУуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц▓│хПгуАН", answer: "уБЛуБУуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцнгчв║уАН", answer: "уБЫуБДуБЛуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЕ╕хС│уАН", answer: "уБХуВУуБ┐" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцГЕха▒уАН", answer: "уБШуВЗуБЖуБ╗уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхОЯхЫауАН", answer: "уБТуВУуБДуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЙИчФ╗уАН", answer: "уБпуВУуБМ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхК╣шГ╜уАН", answer: "уБУуБЖуБоуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЖЕхо╣уАН", answer: "уБкуБДуВИуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМши╝цШОуАН", answer: "уБЧуВЗуБЖуВБуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╡Мш╖пуАН", answer: "уБСуБДуВН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшмЫч┐ТуАН", answer: "уБУуБЖуБЧуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцОеч╢ЪуАН", answer: "уБЫуБдуБЮуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╝ХщААуАН", answer: "уБДуВУуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцИРч╕╛уАН", answer: "уБЫуБДуБЫуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхп╛х┐ЬуАН", answer: "уБЯуБДуБКуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╡МщиУуАН", answer: "уБСуБДуБСуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЕИчеЦуАН", answer: "уБЫуВУуБЮ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшбицГЕуАН", answer: "уБ▓уВЗуБЖуБШуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшдЗцХ░уАН", answer: "уБ╡уБПуБЩуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх┐╡ф╗ПуАН", answer: "уБнуВУуБ╢уБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщаРщЗСуАН", answer: "уВИуБНуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщБйх║жуАН", answer: "уБжуБНуБй" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх┐лх╛йуАН", answer: "уБЛуБДуБ╡уБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╛бца╝уАН", answer: "уБЛуБЛуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч▒│ф┐╡уАН", answer: "уБУуВБуБауВПуВЙ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЪ┤хКЫуАН", answer: "уБ╝уБЖуВКуВЗуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╛Ах╛йуАН", answer: "уБКуБЖуБ╡уБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцПРчд║уАН", answer: "уБжуБДуБШ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЛмхнжуАН", answer: "уБйуБПуБМуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщБйх╜УуАН", answer: "уБжуБНуБиуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф║║цГЕуАН", answer: "уБлуВУуБШуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╝╖цХ╡уАН", answer: "уБНуВЗуБЖуБжуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╕╗хйжуАН", answer: "уБЧуВЕуБ╡" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшжПхИ╢уАН", answer: "уБНуБЫуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╜Пх▒ЕуАН", answer: "уБШуВЕуБЖуБНуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхАНчОЗуАН", answer: "уБ░уБДуВКуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчеЦчИ╢уАН", answer: "уБЭуБ╡" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшбичд║уАН", answer: "уБ▓уВЗуБЖуБШ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЧзхПЛуАН", answer: "уБНуВЕуБЖуВЖуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМценч╕╛уАН", answer: "уБОуВЗуБЖуБЫуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╕ЫщАЯуАН", answer: "уБТуВУуБЭуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╕Ец╜ФуАН", answer: "уБЫуБДуБСуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцОбчВ╣уАН", answer: "уБХуБДуБжуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхРМх▒ЕуАН", answer: "уБйуБЖуБНуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхвЧчпЙуАН", answer: "уБЮуБЖуБбуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЛвхКЫуАН", answer: "уБЫуБДуВКуВЗуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчП╛ха┤уАН", answer: "уБТуВУуБ░" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцОбхПЦуАН", answer: "уБХуБДуБЧуВЕ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╡╢ш│ЫуАН", answer: "уБЬуБгуБХуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцабшИОуАН", answer: "уБУуБЖуБЧуВГ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╡╢хп╛уАН", answer: "уБЬуБгуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч▓╛ч▒│уАН", answer: "уБЫуБДуБ╛уБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчФ╗хГПуАН", answer: "уБМуБЮуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╛йчРЖуАН", answer: "уБОуВК" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЮЭш▒ЖуАН", answer: "уБИуБауБ╛уВБ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЭЗчнЙуАН", answer: "уБНуВУуБиуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшиШш┐░уАН", answer: "уБНуБШуВЕуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц░┤ш│куАН", answer: "уБЩуБДуБЧуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╕╕шнШуАН", answer: "уБШуВЗуБЖуБЧуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЦЗхПеуАН", answer: "уВВуВУуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхАЛф╜УуАН", answer: "уБУуБЯуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчиОщЗСуАН", answer: "уБЬуБДуБНуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщШ▓чКпуАН", answer: "уБ╝уБЖуБпуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхдйцХ╡уАН", answer: "уБжуВУуБжуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЫСшНЙуАН", answer: "уБЦуБгуБЭуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЙАх▒ЮуАН", answer: "уБЧуВЗуБЮуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЬ╝чзСуАН", answer: "уБМуВУуБЛ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщААщЩвуАН", answer: "уБЯуБДуБДуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш▒КхпМуАН", answer: "уБ╗уБЖуБ╡" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчБ╜хо│уАН", answer: "уБХуБДуБМуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшйХф╛буАН", answer: "уБ▓уВЗуБЖуБЛ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцФпх║ЧуАН", answer: "уБЧуБжуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцПРцбИуАН", answer: "уБжуБДуБВуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщАЖхвГуАН", answer: "уБОуВГуБгуБНуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╖╖щЫСуАН", answer: "уБУуВУуБЦуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцАзш│куАН", answer: "уБЫуБДуБЧуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш┐░шкЮуАН", answer: "уБШуВЕуБдуБФ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш│Зца╝уАН", answer: "уБЧуБЛуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчРЖшзгуАН", answer: "уВКуБЛуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцзЛцИРуАН", answer: "уБУуБЖуБЫуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф║ЛцГЕуАН", answer: "уБШуБШуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчВнщЙ▒уАН", answer: "уБЯуВУуБУуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЯ│чиЛуАН", answer: "уБКуВУуБжуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчХЩхнжуАН", answer: "уВКуВЕуБЖуБМуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц░ЧхЬзуАН", answer: "уБНуБВуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчз╗хЛХуАН", answer: "уБДуБйуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф║ЛцХЕуАН", answer: "уБШуБУ" }
      ],
      6: [
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчаВщЙДуАН", answer: "уБХуБжуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшгБхИдуАН", answer: "уБХуБДуБ░уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчзШшФ╡уАН", answer: "уБ▓уБЮуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМча┤чЙЗуАН", answer: "уБпуБ╕уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЩдхО╗уАН", answer: "уБШуВЗуБНуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх┐ахоЯуАН", answer: "уБбуВЕуБЖуБШуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцибхЮЛуАН", answer: "уВВуБСуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх░КцХмуАН", answer: "уБЭуВУуБСуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц╖▒хИ╗уАН", answer: "уБЧуВУуБУуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщкицКШуАН", answer: "уБУуБгуБЫуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╕ЙхЖКуАН", answer: "уБХуВУуБХуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч┐МцЧеуАН", answer: "уВИуБПуБШуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхПОщЫЖуАН", answer: "уБЧуВЕуБЖуБЧуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх┐ГшЗУуАН", answer: "уБЧуВУуБЮуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшикхХПуАН", answer: "уБ╗уБЖуВВуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх░Жш╗НуАН", answer: "уБЧуВЗуБЖуБРуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшЕ╣чЧЫуАН", answer: "уБ╡уБПуБдуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцОичРЖуАН", answer: "уБЩуБДуВК" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╕ох░║уАН", answer: "уБЧуВЕуБПуБЧуВГуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╕ох░ПуАН", answer: "уБЧуВЕуБПуБЧуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщжЦшД│уАН", answer: "уБЧуВЕуБоуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцн╗ф║буАН", answer: "уБЧуБ╝уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчБ░шЙ▓уАН", answer: "уБпуБДуБДуВН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшгЕч╜оуАН", answer: "уБЭуБЖуБб" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЛ╝цЭРуАН", answer: "уБУуБЖуБЦуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф┐│хПеуАН", answer: "уБпуБДуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцПРф╛ЫуАН", answer: "уБжуБДуБНуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЬЧшкнуАН", answer: "уВНуБЖуБйуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЛЕф╗╗уАН", answer: "уБЯуВУуБлуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшнжхВЩуАН", answer: "уБСуБДуБ│" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхНШч┤ФуАН", answer: "уБЯуВУуБШуВЕуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш▓┤щЗНуАН", answer: "уБНуБбуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшжЦчВ╣уАН", answer: "уБЧуБжуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЛЕх╜УуАН", answer: "уБЯуВУуБиуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх░▒ф╗╗уАН", answer: "уБЧуВЕуБЖуБлуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшЗкх╖▒уАН", answer: "уБШуБУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╗КцЩйуАН", answer: "уБУуВУуБ░уВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх┐ахСКуАН", answer: "уБбуВЕуБЖуБУуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхО│щЗНуАН", answer: "уБТуВУуБШуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцХгф╣▒уАН", answer: "уБХуВУуВЙуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхАдцо╡уАН", answer: "уБнуБауВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщжЦчнЛуАН", answer: "уБПуБ│уБЩуБШ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЙ╣хИдуАН", answer: "уБ▓уБпуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхогхСКуАН", answer: "уБЫуВУуБУуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч▓╛хпЖуАН", answer: "уБЫуБДуБ┐уБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцДЯц┐АуАН", answer: "уБЛуВУуБТуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшзгщЩдуАН", answer: "уБЛуБДуБШуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцОичз╗уАН", answer: "уБЩуБДуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцВкхЕЪуАН", answer: "уБВуБПуБиуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф┐│хДкуАН", answer: "уБпуБДуВЖуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЭйхС╜уАН", answer: "уБЛуБПуВБуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщаВф╕КуАН", answer: "уБбуВЗуБЖуБШуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш│ГщЗСуАН", answer: "уБбуВУуБОуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцУНч╕жуАН", answer: "уБЭуБЖуБШуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшТ╕ц░ЧуАН", answer: "уБШуВЗуБЖуБН" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМц▓┐х▓╕уАН", answer: "уБИуВУуБМуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхПОч┤НуАН", answer: "уБЧуВЕуБЖуБоуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЪЗх▒ЕуАН", answer: "уБУуБЖуБНуВЗ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчкУхПгуАН", answer: "уБ╛уБйуБРуБб" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшжПх╛ЛуАН", answer: "уБНуВКуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчПнщХ╖уАН", answer: "уБпуВУуБбуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхоЭчЙйуАН", answer: "уБЯуБЛуВЙуВВуБо" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхВ╖хПгуАН", answer: "уБНуБЪуБРуБб" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшСЧшАЕуАН", answer: "уБбуВЗуБЧуВГ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщгЯцм▓уАН", answer: "уБЧуВЗуБПуВИуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╣▓ц╜оуАН", answer: "уБЛуВУуБбуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшкдшзгуАН", answer: "уБФуБЛуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхнЧх╣ХуАН", answer: "уБШуБ╛уБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМщЩНхПВуАН", answer: "уБУуБЖуБХуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш▓бхоЭуАН", answer: "уБЦуБДуБ╗уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх▒▒щаВуАН", answer: "уБХуВУуБбуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх║жшГ╕уАН", answer: "уБйуБНуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╖╗чЙйуАН", answer: "уБ╛уБНуВВуБо" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцийщЩРуАН", answer: "уБСуВУуБТуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчзБшкЮуАН", answer: "уБЧуБФ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчаВщЗСуАН", answer: "уБХуБНуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЩВхИ╗уАН", answer: "уБШуБУуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхп╕ц│ХуАН", answer: "уБЩуВУуБ╜уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцЖ▓ц│ХуАН", answer: "уБСуВУуБ╜уБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМш┐Фц╕ИуАН", answer: "уБ╕уВУуБХуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцШахГПуАН", answer: "уБИуБДуБЮуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЦДцВкуАН", answer: "уБЬуВУуБВуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчв║шкНуАН", answer: "уБЛуБПуБлуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхРжц▒║уАН", answer: "уБ▓уБСуБд" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшжЦч╖ЪуАН", answer: "уБЧуБЫуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхЛдхЛЩуАН", answer: "уБНуВУуВА" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМшГМщЭвуАН", answer: "уБпуБДуВБуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчаВха┤уАН", answer: "уБЩуБкуБ░" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхп╛чнЦуАН", answer: "уБЯуБДуБХуБП" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╕╗х░ЖуАН", answer: "уБЧуВЕуБЧуВЗуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЦСхХПуАН", answer: "уБОуВВуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМцХмшкЮуАН", answer: "уБСуБДуБФ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч┐Мх╣┤уАН", answer: "уВИуБПуБнуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМхН▒щЩ║уАН", answer: "уБНуБСуВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМф╗БцДЫуАН", answer: "уБШуВУуБВуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх░ЖцЭеуАН", answer: "уБЧуВЗуБЖуВЙуБД" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЯ│цо╡уАН", answer: "уБДуБЧуБауВУ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМх╜╣хЙ▓уАН", answer: "уВДуБПуВПуВК" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМчЙЫф╣│уАН", answer: "уБОуВЕуБЖуБлуВЕуБЖ" },
        { question: "уБУуБоц╝вхнЧуБошкнуБ┐цЦ╣уБпя╝ЯуАМч╢┐цгТуАН", answer: "уВБуВУуБ╝уБЖ" }
      ]
    };

    // уВлуГ╝уГЙхоЪч╛й
    const cardTypes = [
      { name: "ЁЯО▓ЁЯО▓ уВ╡уВдуВ│уГн2хАЛ", description: "2уБдуБоуВ╡уВдуВ│уГнуБохРИшиИуБзщА▓уВБуВЛ", type: "dice2", weight: 15 },
      { name: "ЁЯО▓ЁЯО▓ЁЯО▓ уВ╡уВдуВ│уГн3хАЛ", description: "3уБдуБоуВ╡уВдуВ│уГнуБохРИшиИуБзщА▓уВБуВЛ", type: "dice3", weight: 5 },
      { name: "ЁЯНА уГйуГГуВнуГ╝6", description: "х┐ЕуБЪ6уБМхЗ║уВЛуВ╡уВдуВ│уГн", type: "lucky6", weight: 10 },
      { name: "ЁЯТе хжихо│уВлуГ╝уГЙ", description: "чЫ╕цЙЛуВТ3уГЮуВ╣цИ╗уБЩ", type: "attack", weight: 10 },
      { name: "ЁЯЪА уВ╕уГгуГ│уГЧ", description: "3уГЮуВ╣щА▓уВА", type: "jump", weight: 10 },
      { name: "ЁЯЫбя╕П уВ╖уГ╝уГлуГЙ", description: "цФ╗цТГуВТ1хЫЮщШ▓уБР", type: "shield", weight: 15 },
      { name: "ЁЯТг чИЖчЩ║", description: "2ф║║уБиуВВуВ╣уВ┐уГ╝уГИуБлцИ╗уВЛ", type: "bomb", weight: 5 },
      { name: "ЁЯЪз уВ╣уГИуГГуГЧ", description: "чЫ╕цЙЛуВТ1хЫЮф╝СуБ┐уБлуБЩуВЛ", type: "stop", weight: 10 },
      { name: "ЁЯкВ уГйуГ│уГАуГа", description: "уБйуБУуБЛхИеуБоха┤цЙАуБлуГЖуГмуГЭуГ╝уГИуБЩуВЛ", type: "random", weight: 10 },
      { name: "ЁЯе╖ ц│ецгТ", description: "чЫ╕цЙЛуБоуВлуГ╝уГЙуВТуГйуГ│уГАуГауБз1цЮЪхекуБИуВЛ", type: "steal", weight: 10 }
    ];
    function getRandomCard() {
      const totalWeight = cardTypes.reduce((sum, card) => sum + card.weight, 0);
      let random = Math.random() * totalWeight;
      for (const card of cardTypes) {
        random -= card.weight;
        if (random <= 0) return { ...card };
      }
      return { ...cardTypes[0] };
    }

    // хЕехКЫуГнуГГуВп
    function lockInputs() {
      turnLocked = true;
      document.getElementById('rollBtn').disabled = true;
      document.getElementById('useCardBtn1').disabled = true;
      document.getElementById('useCardBtn2').disabled = true;
    }
    function unlockInputsForCurrentPlayer() {
      turnLocked = false;
      if (isAIGame && currentPlayer === 2) {
        document.getElementById('rollBtn').disabled = true;
        document.getElementById('useCardBtn1').disabled = true;
        document.getElementById('useCardBtn2').disabled = true;
      } else {
        document.getElementById('rollBtn').disabled = false;
        document.getElementById('useCardBtn1').disabled = (currentPlayer !== 1 || players[1].cards.length === 0);
        document.getElementById('useCardBtn2').disabled = (currentPlayer !== 2 || players[2].cards.length === 0);
      }
    }

    // уГЧуГмуВдуГдуГ╝2хЕехКЫцмДхИЗуВКцЫ┐уБИ
    function togglePlayer2Input() {
      const playerCount = document.getElementById('playerCountSelect').value;
      const player2Group = document.getElementById('player2Group');
      player2Group.style.display = (playerCount === '1') ? 'none' : 'block';
    }

    // хИЭцЬЯшинхоЪтЖТшкмцШО
    function showInstructions() {
      const player1Name = document.getElementById('player1Name').value.trim();
      playerCount = parseInt(document.getElementById('playerCountSelect').value);
      if (!player1Name) { alert('уГЧуГмуВдуГдуГ╝хРНуВТхЕехКЫуБЧуБжуБПуБауБХуБД'); return; }
      players[1].name = player1Name;

      if (playerCount === 1) {
        isAIGame = true;
        players[2].name = 'уВ│уГ│уГФуГеуГ╝уВ┐уГ╝';
      } else {
        const player2Name = document.getElementById('player2Name').value.trim();
        if (!player2Name) { alert('уГЧуГмуВдуГдуГ╝2уБохРНхЙНуВТхЕехКЫуБЧуБжуБПуБауБХуБД'); return; }
        isAIGame = false;
        players[2].name = player2Name;
      }
      selectedGrade = parseInt(document.getElementById('gradeSelect').value);
      saveSettings();

      document.getElementById('setupScreen').style.display = 'none';
      document.getElementById('instructionsScreen').style.display = 'flex';
    }

    function startGame() {
      // шкмцШОчФ╗щЭвуВТщЦЙуБШуВЛ
      document.getElementById('instructionsScreen').style.display = 'none';

      // хнжх╣┤шбичд║я╝ИуВ┐уВдуГИуГлцЬлх░╛я╝ЙтАФцЧвуБлуБВуВЛха┤хРИуБпш┐╜хКауБЧуБкуБД
      const titleElement = document.querySelector('.title');
      if (!titleElement.querySelector('.grade-display')) {
        titleElement.insertAdjacentHTML('beforeend', `<span class="grade-display" style="font-size:1rem;opacity:.8">я╝И${selectedGrade}х╣┤чФЯя╝Й</span>`);
      }

      prepareFirstPlayerRoulette();
      document.getElementById('firstPlayerModal').style.display = 'flex';
    }

    function prepareFirstPlayerRoulette(){
      const p1 = players[1].name || 'уГЧуГмуВдуГдуГ╝1';
      const p2 = isAIGame ? 'уВ│уГ│уГФуГеуГ╝уВ┐уГ╝' : (players[2].name || 'уГЧуГмуВдуГдуГ╝2');
      document.getElementById('rouletteP1Name').textContent = p1;
      document.getElementById('rouletteP2Name').textContent = p2;
      document.getElementById('rouletteMsg').textContent = 'уВ╣уВ┐уГ╝уГИуВТцК╝уБЩуБицК╜щБ╕уБЧуБ╛уБЩя╝Б';
      document.getElementById('rouletteProceedBtn').style.display = 'none';
      document.getElementById('rouletteStartBtn').style.display = 'inline-block';
      document.getElementById('rouletteP1').classList.remove('active');
      document.getElementById('rouletteP2').classList.remove('active');
      rouletteDecided = null;
    }

    function startFirstPlayerRoulette(){
      const chip1 = document.getElementById('rouletteP1');
      const chip2 = document.getElementById('rouletteP2');
      const msg = document.getElementById('rouletteMsg');
      document.getElementById('rouletteStartBtn').style.display = 'none';
      msg.textContent = 'уБРуВЛуБРуВЛуАЬтАж';
      rouletteSpins = 0;
      let highlight = 1;

      rouletteInterval = setInterval(() => {
        highlight = (highlight === 1 ? 2 : 1);
        chip1.classList.toggle('active', highlight === 1);
        chip2.classList.toggle('active', highlight === 2);
        rouletteSpins++;

        if (rouletteSpins > 20) {
          clearInterval(rouletteInterval);
          const winner = Math.random() < 0.5 ? 1 : 2;
          rouletteDecided = winner;
          chip1.classList.toggle('active', winner === 1);
          chip2.classList.toggle('active', winner === 2);
          const winnerIcon = (winner === 1) ? 'ЁЯСж' : (isAIGame ? 'ЁЯдЦ' : 'ЁЯСз');
          const winnerName = (winner === 1) ? (players[1].name || 'уГЧуГмуВдуГдуГ╝1') : (isAIGame ? 'уВ│уГ│уГФуГеуГ╝уВ┐уГ╝' : (players[2].name || 'уГЧуГмуВдуГдуГ╝2'));
          msg.textContent = `ЁЯОЙ хЕИшбМуБп ${winnerIcon} ${winnerName}я╝Б`;
          document.getElementById('rouletteProceedBtn').style.display = 'inline-block';
        }
      }, 120);
    }

    function proceedAfterRoulette(){
      document.getElementById('firstPlayerModal').style.display = 'none';
      document.getElementById('gameContainer').style.display = 'flex';
      initializeBoard();
      currentPlayer = rouletteDecided || 1;
      turnLocked = false;
      updateTurnDisplay();
      startPlayerTurn();
    }

    // чЫдщЭвхИЭцЬЯхМЦя╝ИSхнЧя╝Й
    function initializeBoard() {
      const board = document.getElementById('gameBoard');
      board.innerHTML = '';
      for (let i = 0; i < 30; i++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.id = `cell-${i}`;

        // SхнЧщЕНч╜о
        let row, col;
        if (i <= 9) { row = 0; col = i; }
        else if (i <= 19) { row = 1; col = 19 - i; }
        else { row = 2; col = i - 20; }
        cell.style.gridRow = row + 1;
        cell.style.gridColumn = col + 1;

        if (i === 0) {
          cell.classList.add('start');
          cell.textContent = 'START';
        } else if (i === 29) {
          cell.classList.add('goal');
          cell.textContent = 'GOAL';
        } else {
          const colorClass = `color${Math.floor(Math.random() * 10) + 1}`;
          cell.classList.add(colorClass);
        }

        // щА▓шбМцЦ╣хРСчЯвхН░
        if (i < 29) {
          const arrow = document.createElement('div');
          arrow.style.position = 'absolute';
          arrow.style.fontSize = '0.6rem';
          arrow.style.color = '#fff';
          arrow.style.fontWeight = 'bold';
          arrow.style.textShadow = '1px 1px 2px rgba(0,0,0,0.8)';

          if (i < 9) {
            arrow.textContent = 'тЖТ';
            arrow.style.right = '-8px';
            arrow.style.top = '50%';
            arrow.style.transform = 'translateY(-50%)';
          } else if (i === 9) {
            arrow.textContent = 'тЖУ';
            arrow.style.bottom = '-8px';
            arrow.style.left = '50%';
            arrow.style.transform = 'translateX(-50%)';
          } else if (i >= 10 && i < 19) {
            arrow.textContent = 'тЖР';
            arrow.style.left = '-8px';
            arrow.style.top = '50%';
            arrow.style.transform = 'translateY(-50%)';
          } else if (i === 19) {
            arrow.textContent = 'тЖУ';
            arrow.style.bottom = '-8px';
            arrow.style.left = '50%';
            arrow.style.transform = 'translateX(-50%)';
          } else if (i >= 20 && i < 28) {
            arrow.textContent = 'тЖТ';
            arrow.style.right = '-8px';
            arrow.style.top = '50%';
            arrow.style.transform = 'translateY(-50%)';
          }
          if (arrow.textContent) cell.appendChild(arrow);
        }

        board.appendChild(cell);
      }
      updatePlayerPositions();
    }

    // щзТуБощЕНч╜оцЫ┤цЦ░
    function updatePlayerPositions() {
      document.querySelectorAll('.player').forEach(p => p.remove());

      const cell1 = document.getElementById(`cell-${players[1].position}`);
      if (cell1) {
        const player1 = document.createElement('div');
        player1.className = 'player player1';
        player1.textContent = 'ЁЯСж';
        cell1.appendChild(player1);
      }

      const cell2 = document.getElementById(`cell-${players[2].position}`);
      if (cell2) {
        const player2 = document.createElement('div');
        player2.className = 'player player2';
        player2.textContent = isAIGame ? 'ЁЯдЦ' : 'ЁЯСз';
        cell2.appendChild(player2);
      }

      document.getElementById('player1NameDisplay').textContent = `ЁЯСж ${players[1].name} (${players[1].position}уГЮуВ╣чЫо)`;
      const player2Icon = isAIGame ? 'ЁЯдЦ' : 'ЁЯСз';
      document.getElementById('player2NameDisplay').textContent = `${player2Icon} ${players[2].name} (${players[2].position}уГЮуВ╣чЫо)`;

      updatePlayerCards(1);
      updatePlayerCards(2);

      document.getElementById('useCardBtn1').style.display = players[1].cards.length > 0 ? 'block' : 'none';
      document.getElementById('useCardBtn2').style.display = players[2].cards.length > 0 ? 'block' : 'none';
    }

    function updatePlayerCards(playerNum) {
      const cardsList = document.getElementById(`player${playerNum}CardsList`);
      cardsList.innerHTML = '';
      players[playerNum].cards.forEach((card) => {
        const cardElement = document.createElement('div');
        cardElement.className = 'mini-card';
        cardElement.textContent = card.name.split(' ')[0];
        cardElement.title = card.name + ': ' + card.description;
        cardsList.appendChild(cardElement);
      });
    }

    // уВ╡уВдуВ│уГн
    function rollDice() {
      if (gameEnded || turnLocked) return;
      lockInputs();
      pendingAnswerFor = currentPlayer;

      if (players[currentPlayer].skipTurn) {
        players[currentPlayer].skipTurn = false;
        alert(`уГЧуГмуВдуГдуГ╝${currentPlayer}уБп1хЫЮф╝СуБ┐уБзуБЩя╝Б`);
        const t = setTimeout(() => switchToNextPlayer(), 1000);
        timers.push(t);
        return;
      }
      rollMultipleDice(1);
    }

    function rollMultipleDice(diceCount) {
      const diceArea = document.getElementById('diceArea');
      const rollBtn = document.getElementById('rollBtn');

      diceArea.innerHTML = '';
      const diceElements = [];
      for (let i = 0; i < diceCount; i++) {
        const dice = document.createElement('div');
        dice.className = 'dice';
        dice.id = `dice-${i}`;
        dice.textContent = '?';
        diceArea.appendChild(dice);
        diceElements.push(dice);
      }
      rollBtn.disabled = true;

      diceElements.forEach(dice => dice.classList.add('rolling'));

      let rollCount = 0;
      const diceValues = [];
      const rollInterval = setInterval(() => {
        diceElements.forEach(dice => { dice.textContent = Math.floor(Math.random() * 6) + 1; });
        rollCount++;
        if (rollCount > 10) {
          clearInterval(rollInterval);
          let total = 0;
          diceElements.forEach((dice) => {
            let value = lucky6Active ? 6 : (Math.floor(Math.random() * 6) + 1);
            dice.textContent = value;
            dice.classList.remove('rolling');
            diceValues.push(value);
            total += value;
          });
          diceValue = total;
          if (lucky6Active) { lucky6Active = false; }

          if (diceCount > 1) {
            setTimeout(() => { alert(`ЁЯО▓ уВ╡уВдуВ│уГнуБохРИшиИ: ${diceValues.join(' + ')} = ${total}`); }, 500);
          }

          const myTurn = turnId;
          const isAITurn = isAIGame && currentPlayer === 2 && pendingAnswerFor === 2;
          const nextStep = isAITurn ? aiAnswerQuestion : showQuestion;
          const t = setTimeout(() => {
            if (gameEnded || myTurn !== turnId) return;
            nextStep();
          }, diceCount > 1 ? 1500 : 500);
          timers.push(t);
        }
      }, 100);
    }

    // хХПщбМшбичд║
    function showQuestion() {
      if (isAIGame && currentPlayer === 2) {
        const modal = document.getElementById('questionModal');
        if (modal) modal.style.display = 'none';
        aiAnswerQuestion();
        return;
      }
      const questions = questionsByGrade[selectedGrade];
      currentQuestion = questions[Math.floor(Math.random() * questions.length)];
      document.getElementById('questionText').textContent = currentQuestion.question;
      const answerInput = document.getElementById('answerInput');
      answerInput.value = '';
      openModal('questionModal', '#answerInput');

      turnLocked = false;
      document.getElementById('rollBtn').disabled = true;
      document.getElementById('useCardBtn1').disabled = true;
      document.getElementById('useCardBtn2').disabled = true;
    }

    function submitAnswer() {
      if (turnLocked) { console.warn('submit blocked by turnLocked'); return; }
      const answerInput = document.getElementById('answerInput');
      const userAnswer = normalize(answerInput.value);
      if (!userAnswer) { alert('чнФуБИуВТхЕехКЫуБЧуБжуБПуБауБХуБД'); return; }
      lockInputs();
      checkAnswer(userAnswer, pendingAnswerFor);
    }

    function checkAnswer(userAnswer, playerNum = null) {
      closeModal('questionModal');
      const actualPlayer = playerNum ?? pendingAnswerFor;
      console.log(`уГЧуГмуВдуГдуГ╝${actualPlayer}уБохЫЮчнФ: ${userAnswer}`);
      const correct = normalize(currentQuestion.answer);
      if (userAnswer === correct) {
        console.log(`уГЧуГмуВдуГдуГ╝${actualPlayer}цнгшзг`);
        showAnswerPopup(true, diceValue);
      } else {
        console.log(`уГЧуГмуВдуГдуГ╝${actualPlayer}ф╕Нцнгшзг`);
        showAnswerPopup(false, 0, currentQuestion.answer);
      }
    }

    function switchToNextPlayer() {
      if (gameEnded || isSwitchingTurn) return;
      isSwitchingTurn = true;

      timers.forEach(id => { clearTimeout(id); clearInterval(id); });
      timers.length = 0;
      closeAllPopups();
      aiBusy = false;
      pendingAnswerFor = null;

      console.log(`=== уВ┐уГ╝уГ│ф║дф╗гщЦЛхзЛ: уГЧуГмуВдуГдуГ╝${currentPlayer} ===`);
      lockInputs();
      const previousPlayer = currentPlayer;
      currentPlayer = currentPlayer === 1 ? 2 : 1;
      turnId++;
      console.log(`уГЧуГмуВдуГдуГ╝${previousPlayer} тЖТ уГЧуГмуВдуГдуГ╝${currentPlayer}уБлф║дф╗г (turnId=${turnId})`);

      updateTurnDisplay();
      const t = setTimeout(() => {
        if (!gameEnded) startPlayerTurn();
        setTimeout(() => { isSwitchingTurn = false; }, 100);
      }, 300);
      timers.push(t);
    }

    function updateTurnDisplay() {
      document.getElementById('player1Info').classList.remove('active');
      document.getElementById('player2Info').classList.remove('active');
      document.getElementById(`player${currentPlayer}Info`).classList.add('active');

      document.getElementById('rollBtn').disabled = true;
      document.getElementById('useCardBtn1').disabled = true;
      document.getElementById('useCardBtn2').disabled = true;

      const rollBtn = document.getElementById('rollBtn');
      rollBtn.textContent = `уГЧуГмуВдуГдуГ╝${currentPlayer}уБочХк`;
    }

    function startPlayerTurn() {
      const rollBtn = document.getElementById('rollBtn');
      const diceArea = document.getElementById('diceArea');
      diceArea.innerHTML = '<div class="dice" id="dice">?</div>';

      if (isAIGame && currentPlayer === 2) {
        if (aiBusy) return;
        rollBtn.textContent = 'уВ│уГ│уГФуГеуГ╝уВ┐уГ╝уБочХк';
        rollBtn.style.cursor = 'not-allowed';
        rollBtn.title = 'уВ│уГ│уГФуГеуГ╝уВ┐уГ╝уБМшАГуБИф╕нуБзуБЩ';
        console.log('AIуВ┐уГ╝уГ│щЦЛхзЛ');
        const myTurn = turnId;
        const t = setTimeout(() => {
          if (!gameEnded && currentPlayer === 2 && myTurn === turnId) aiTurn();
        }, 1500);
        timers.push(t);
      } else {
        rollBtn.textContent = 'уВ╡уВдуВ│уГн';
        rollBtn.style.cursor = 'pointer';
        rollBtn.title = 'уВпуГкуГГуВпуБЧуБжуВ╡уВдуВ│уГнуВТцМпуВЛ';
        console.log(`уГЧуГмуВдуГдуГ╝${currentPlayer}уБоуВ┐уГ╝уГ│щЦЛхзЛ`);
        unlockInputsForCurrentPlayer();
      }
    }

    function endCurrentPlayerTurn() { switchToNextPlayer(); }

    function showAnswerPopup(isCorrect, steps, info = '') {
      const popup = document.getElementById('answerPopup');
      const content = document.getElementById('answerPopupContent');
      const title = document.getElementById('answerResultTitle');
      const message = document.getElementById('answerResultMessage');

      lastAnswerCorrect = !!isCorrect;
      if (isCorrect) {
        content.style.background = 'linear-gradient(135deg, #27ae60, #2ecc71)';
        title.textContent = 'ЁЯОЙ цнгшзгя╝Б ЁЯОЙ';
        message.textContent = `${steps}уГЮуВ╣щА▓уБ┐уБ╛уБЩя╝Б`;
      } else {
        content.style.background = 'linear-gradient(135deg, #e74c3c, #c0392b)';
        title.textContent = 'тЭМ ф╕Нцнгшзг... тЭМ';
        if (info && info !== (currentQuestion?.answer ?? '')) {
          message.textContent = info;
        } else if (info) {
          message.textContent = `цнгшзгуБпуАМ${info}уАНуБзуБЧуБЯ`;
        } else {
          message.textContent = 'цоЛх┐╡я╝Б';
        }
      }
      popup.style.display = 'flex';
    }

    function closeAnswerPopup() {
      document.getElementById('answerPopup').style.display = 'none';
      const isCorrect = !!lastAnswerCorrect;
      lastAnswerCorrect = null;
      if (isCorrect) {
        const actualPlayer = pendingAnswerFor || currentPlayer;
        movePlayer(diceValue, actualPlayer);
        if (gameEnded) return;
        const t = setTimeout(() => {
          if (gameEnded) return;
          if (Math.random() < 0.7) {
            const cardCount = Math.random() < 0.2 ? 2 : 1;
            giveCards(actualPlayer, cardCount);
          } else {
            console.log('цнгшзгтЖТуВлуГ╝уГЙчН▓х╛ЧуБкуБЧтЖТуВ┐уГ╝уГ│ч╡Вф║Ж');
            switchToNextPlayer();
          }
        }, 1000);
        timers.push(t);
      } else {
        console.log('ф╕НцнгшзгтЖТуВ┐уГ╝уГ│ч╡Вф║Ж');
        switchToNextPlayer();
      }
    }

    function movePlayer(steps, playerNum = null) {
      if (gameEnded) return;
      const targetPlayer = playerNum || currentPlayer;
      const oldPosition = players[targetPlayer].position;
      const newPosition = Math.min(oldPosition + steps, 29);
      console.log(`уГЧуГмуВдуГдуГ╝${targetPlayer}: ${oldPosition} тЖТ ${newPosition} (${steps}уГЮуВ╣щА▓уВА)`);

      animateMovement(oldPosition, newPosition, targetPlayer, () => {
        players[targetPlayer].position = newPosition;
        updatePlayerPositions();
        if (newPosition >= 29) {
          if (!gameEnded) endGame(targetPlayer);
          return;
        }
      });
    }

    function animateMovement(from, to, playerNum, callback) {
      if (from === to) { callback(); return; }
      let current = from;
      let lastTime = 0;
      const stepDelay = 300;
      const step = (currentTime) => {
        if (gameEnded) return;
        if (currentTime - lastTime >= stepDelay) {
          if (current < to) {
            current++;
            players[playerNum].position = current;
            updatePlayerPositions();
            lastTime = currentTime;
          } else {
            callback(); return;
          }
        }
        requestAnimationFrame(step);
      };
      requestAnimationFrame(step);
    }

    function giveCards(playerNum = null, count = 1) {
      const targetPlayer = playerNum || currentPlayer;
      const obtainedCards = [];
      for (let i = 0; i < count; i++) {
        const randomCard = getRandomCard();
        players[targetPlayer].cards.push(randomCard);
        obtainedCards.push(randomCard);
      }
      const t = setTimeout(() => {
        if (count === 1) {
          showCardPopup(obtainedCards[0]);
        } else {
          showMultipleCardPopup(obtainedCards);
        }
        updatePlayerPositions();
        if (isAIGame && targetPlayer === 2) {
          const t2 = setTimeout(() => { closeCardPopup(); }, 2000);
          timers.push(t2);
        }
      }, 500);
      timers.push(t);
    }

    function showMultipleCardPopup(cards) {
      const cardNames = cards.map(card => card.name).join('уАБ');
      document.getElementById('popupCardName').textContent = `${cards.length}цЮЪчН▓х╛Чя╝Б`;
      document.getElementById('popupCardDesc').textContent = cardNames;
      document.getElementById('cardPopup').style.display = 'flex';
    }
    function showCardPopup(card) {
      document.getElementById('popupCardName').textContent = card.name;
      document.getElementById('popupCardDesc').textContent = card.description;
      document.getElementById('cardPopup').style.display = 'flex';
    }
    function closeCardPopup() {
      if (isClosingCardPopup) return;
      isClosingCardPopup = true;
      document.getElementById('cardPopup').style.display = 'none';
      if (!gameEnded) {
        console.log('уВлуГ╝уГЙчН▓х╛ЧтЖТуВ┐уГ╝уГ│ч╡Вф║Ж');
        switchToNextPlayer();
      }
      setTimeout(() => { isClosingCardPopup = false; }, 100);
    }

    function showShieldPopup() { document.getElementById('shieldPopup').style.display = 'flex'; }
    function closeShieldPopup() { document.getElementById('shieldPopup').style.display = 'none'; }

    function showCardUsePopup(card) {
      document.getElementById('usedCardName').textContent = card.name;
      document.getElementById('usedCardDesc').textContent = card.description;
      document.getElementById('cardUsePopup').style.display = 'flex';
    }
    function closeCardUsePopup() {
      document.getElementById('cardUsePopup').style.display = 'none';
      if (window.pendingCardEffect) {
        const { card, playerNum, cardIndex, opponent } = window.pendingCardEffect;
        executeCardEffect(card, playerNum, cardIndex, opponent);
        window.pendingCardEffect = null;
      }
    }

    // AI
    function aiTurn() {
      if (gameEnded || currentPlayer !== 2) return;
      if (aiBusy) return;
      aiBusy = true;
      const myTurn = turnId;
      console.log('AIуБоуВ┐уГ╝уГ│щЦЛхзЛ');

      if (players[2].skipTurn) {
        players[2].skipTurn = false;
        showAnswerPopup(false, 0, 'уВ│уГ│уГФуГеуГ╝уВ┐уГ╝уБп1хЫЮф╝СуБ┐уБзуБЩ');
        const t = setTimeout(() => { closeAnswerPopup(); switchToNextPlayer(); }, 2000);
        timers.push(t);
        return;
      }

      const usableIdx = players[2].cards
        .map((c, i) => ({ c, i }))
        .filter(x => x.c.type !== 'shield')
        .map(x => x.i);

      if (usableIdx.length > 0 && Math.random() < 0.9) {
        const cardIndex = usableIdx[Math.floor(Math.random() * usableIdx.length)];
        console.log('AIуБМуВлуГ╝уГЙуВТф╜┐чФи');
        useCard(2, cardIndex);
        return;
      }
      console.log('AIуБМуВ╡уВдуВ│уГнуВТцМпуВЛ');
      aiRollDice();
    }

    function aiRollDice() {
      const diceArea = document.getElementById('diceArea');
      diceArea.innerHTML = '<div class="dice" id="dice">?</div>';
      const dice = document.getElementById('dice');
      const myTurn = turnId;
      dice.classList.add('rolling');
      let rollCount = 0;
      const rollInterval = setInterval(() => {
        dice.textContent = Math.floor(Math.random() * 6) + 1;
        rollCount++;
        if (rollCount > 10) {
          clearInterval(rollInterval);
          if (lucky6Active) { diceValue = 6; lucky6Active = false; }
          else { diceValue = Math.floor(Math.random() * 6) + 1; }
          dice.textContent = diceValue;
          dice.classList.remove('rolling');
          const t = setTimeout(() => {
            if (gameEnded || currentPlayer !== 2 || myTurn !== turnId) return;
            aiAnswerQuestion();
          }, 500);
          timers.push(t);
        }
      }, 100);
      timers.push(rollInterval);
    }

    function aiAnswerQuestion() {
      if (gameEnded || currentPlayer !== 2) return;
      const myTurn = turnId;
      console.log(`AIхХПщбМхЫЮчнФхЗжчРЖщЦЛхзЛ - уВ╡уВдуВ│уГнуБочЫо: ${diceValue}`);
      pendingAnswerFor = 2;

      const questions = questionsByGrade[selectedGrade];
      currentQuestion = questions[Math.floor(Math.random() * questions.length)];

      const isCorrect = Math.random() < 0.95;
      if (isCorrect) {
        console.log(`AIцнгшзг - ${diceValue}уГЮуВ╣щА▓уВАф║ИхоЪ`);
        showAnswerPopup(true, diceValue);
        const t1 = setTimeout(() => {
          if (gameEnded || currentPlayer !== 2 || myTurn !== turnId) return;
          closeAnswerPopup();
        }, 1500);
        timers.push(t1);
      } else {
        console.log('AIф╕Нцнгшзг - щА▓уБ╛уБкуБД');
        showAnswerPopup(false, 0, 'хХПщбМуБлщЦУщБХуБИуБ╛уБЧуБЯ');
        const t = setTimeout(() => {
          if (gameEnded || currentPlayer !== 2 || myTurn !== turnId) return;
          closeAnswerPopup();
        }, 2000);
        timers.push(t);
      }
    }

    // уВлуГ╝уГЙуГбуГЛуГеуГ╝
    function showCardMenu(playerNum) {
      if (playerNum !== currentPlayer || turnLocked) return;
      const modal = document.getElementById('cardModal');
      const cardList = document.getElementById('cardList');
      cardList.innerHTML = '';

      players[playerNum].cards.forEach((card, index) => {
        if (card.type === 'shield') {
          const cardItem = document.createElement('div');
          cardItem.className = 'card-item';
          cardItem.style.opacity = '0.5';
          cardItem.style.cursor = 'not-allowed';
          cardItem.innerHTML = `<div style="font-size: 1.2rem; margin-bottom: 5px;">${card.name}</div><div class="card-description">шЗкхЛХчЩ║хЛХя╝Иф╜┐чФиф╕НхПпя╝Й</div>`;
          cardList.appendChild(cardItem);
        } else {
          const cardItem = document.createElement('div');
          cardItem.className = 'card-item';
          cardItem.innerHTML = `<div style="font-size: 1.2rem; margin-bottom: 5px;">${card.name}</div><div class="card-description">${card.description}</div>`;
          cardItem.onclick = () => useCard(playerNum, index);
          cardList.appendChild(cardItem);
        }
      });
      modal.style.display = 'flex';
    }
    function closeCardMenu() { document.getElementById('cardModal').style.display = 'none'; }

    function useCard(playerNum, cardIndex) {
      if (turnLocked && !(isAIGame && playerNum === 2)) return;
      lockInputs();
      const card = players[playerNum].cards[cardIndex];
      const opponent = playerNum === 1 ? 2 : 1;
      closeCardMenu();

      showCardUsePopup(card);

      if (isAIGame && playerNum === 2) {
        const t = setTimeout(() => {
          closeCardUsePopup();
          executeCardEffect(card, playerNum, cardIndex, opponent);
        }, 1500);
        timers.push(t);
      } else {
        window.pendingCardEffect = { card, playerNum, cardIndex, opponent };
      }
    }

    function executeCardEffect(card, playerNum, cardIndex, opponent) {
      switch(card.type) {
        case 'shield':
          console.log('ЁЯЫбя╕П уВ╖уГ╝уГлуГЙуБпшЗкхЛХчЩ║хЛХуБоуБЯуВБцЙЛхЛХф╜┐чФиф╕НхПп');
          if (isAIGame && playerNum === 2) {
            setTimeout(() => { if (!gameEnded && currentPlayer === 2) aiRollDice(); }, 400);
          } else { unlockInputsForCurrentPlayer(); }
          return;

        case 'dice2':
          pendingAnswerFor = playerNum;
          rollMultipleDice(2);
          players[playerNum].cards.splice(cardIndex, 1);
          updatePlayerPositions();
          return;

        case 'dice3':
          pendingAnswerFor = playerNum;
          rollMultipleDice(3);
          players[playerNum].cards.splice(cardIndex, 1);
          updatePlayerPositions();
          return;

        case 'lucky6':
          lucky6Active = true;
          console.log('уГйуГГуВнуГ╝6хК╣цЮЬуВТцЬЙхК╣хМЦ');
          alert('ЁЯНА уГйуГГуВнуГ╝6хК╣цЮЬуБМцЬЙхК╣уБлуБкуВКуБ╛уБЧуБЯя╝БцмбуБоуВ╡уВдуВ│уГнуБзх┐ЕуБЪ6уБМхЗ║уБ╛уБЩя╝Б');
          break;

        case 'attack':
          if (hasShield(opponent)) { useShield(opponent); showShieldPopup(); }
          else {
            players[opponent].position = Math.max(0, players[opponent].position - 3);
            alert('ЁЯТе чЫ╕цЙЛуВТ3уГЮуВ╣цИ╗уБЧуБ╛уБЧуБЯя╝Б');
            updatePlayerPositions();
          }
          break;

        case 'jump':
          alert('ЁЯЪА уВ╕уГгуГ│уГЧ: 3уГЮуВ╣щА▓уБ┐уБ╛уБЩя╝Б');
          movePlayer(3, playerNum);
          break;

        case 'bomb':
          if (hasShield(opponent)) { useShield(opponent); showShieldPopup(); }
          else {
            players[1].position = 0; players[2].position = 0;
            alert('ЁЯТг чИЖчЩ║я╝Бф╕буГЧуГмуВдуГдуГ╝уБМуВ╣уВ┐уГ╝уГИуБлцИ╗уВКуБ╛уБЧуБЯя╝Б');
            updatePlayerPositions();
          }
          break;

        case 'stop':
          if (hasShield(opponent)) { useShield(opponent); showShieldPopup(); }
          else { players[opponent].skipTurn = true; alert('ЁЯЪз чЫ╕цЙЛуВТ1хЫЮф╝СуБ┐уБлуБЧуБ╛уБЧуБЯя╝Б'); }
          break;

        case 'random':
          const randomPos = Math.floor(Math.random() * 28) + 1; // 1..28
          players[playerNum].position = randomPos;
          alert(`ЁЯкВ уГйуГ│уГАуГауГЖуГмуГЭуГ╝уГИ: ${randomPos}чХкчЫоуБоуГЮуВ╣уБлчз╗хЛХуБЧуБ╛уБЧуБЯя╝Б`);
          updatePlayerPositions();
          break;

        case 'steal':
          if (hasShield(opponent)) { useShield(opponent); showShieldPopup(); }
          else if (players[opponent].cards.length > 0) {
            const stolenIndex = Math.floor(Math.random() * players[opponent].cards.length);
            const stolenCard = players[opponent].cards.splice(stolenIndex, 1)[0];
            players[playerNum].cards.push(stolenCard);
            alert(`ЁЯе╖ чЫ╕цЙЛуБЛуВЙуАМ${stolenCard.name}уАНуВТхекуБДуБ╛уБЧуБЯя╝Б`);
            updatePlayerPositions();
          } else { alert('ЁЯе╖ чЫ╕цЙЛуБпуВлуГ╝уГЙуВТцМБуБгуБжуБДуБ╛уБЫуВУ...'); }
          break;
      }

      // уВлуГ╝уГЙуВТц╢Иш▓╗я╝Иdice2/3уБпф╕КуБзц╕ИуБ┐я╝Й
      if (!['dice2','dice3'].includes(card.type)) {
        players[playerNum].cards.splice(cardIndex, 1);
        updatePlayerPositions();
      }

      if (players[playerNum].position >= 29) { endGame(playerNum); return; }

      console.log(`уГЧуГмуВдуГдуГ╝${playerNum}уБМуВлуГ╝уГЙуАМ${card.name}уАНуВТф╜┐чФихоМф║Ж`);
      if (['dice2','dice3'].includes(card.type)) {
        console.log(`${card.name}уВлуГ╝уГЙф╜┐чФиуАБхХПщбМхЫЮчнФх╛МуБлуВ┐уГ╝уГ│ч╡Вф║Жф║ИхоЪ`);
        return;
      }

      if (!gameEnded) {
        if (isAIGame && playerNum === 2) {
          console.log(`AIуБМуАМ${card.name}уАНф╜┐чФи тЖТ шЗкхЛХуБзуВ╡уВдуВ│уГнуБ╕`);
          const t = setTimeout(() => { if (!gameEnded && currentPlayer === 2) aiRollDice(); }, 800);
          timers.push(t);
        } else {
          console.log(`уВлуГ╝уГЙуАМ${card.name}уАНф╜┐чФиуАБуВ┐уГ╝уГ│ч╢Щч╢Ъя╝Иф║║щЦУя╝Й`);
          const t = setTimeout(() => { if (!gameEnded) unlockInputsForCurrentPlayer(); }, 300);
          timers.push(t);
        }
      }
    }

    function hasShield(playerNum) {
      return players[playerNum].cards.some(card => card.type === 'shield');
    }
    function useShield(playerNum) {
      const shieldIndex = players[playerNum].cards.findIndex(card => card.type === 'shield');
      if (shieldIndex !== -1) {
        players[playerNum].cards.splice(shieldIndex, 1);
        updatePlayerPositions();
      }
    }

    // уВнуГ╝цУНф╜Ь
    document.addEventListener('DOMContentLoaded', function() {
      loadSettings();
      togglePlayer2Input();
    });
    document.addEventListener('keydown', function(event) {
      if (event.key === 'Enter') {
        if (document.getElementById('questionModal').style.display === 'flex') { submitAnswer(); return; }
        if (document.getElementById('cardPopup').style.display === 'flex') { closeCardPopup(); return; }
        if (document.getElementById('cardUsePopup').style.display === 'flex') { closeCardUsePopup(); return; }
        if (document.getElementById('shieldPopup').style.display === 'flex') { closeShieldPopup(); return; }
        if (document.getElementById('answerPopup').style.display === 'flex') { closeAnswerPopup(); return; }
        if (document.getElementById('winnerModal').style.display === 'flex') { resetGame(); return; }

        const rollBtn = document.getElementById('rollBtn');
        if (rollBtn && !rollBtn.disabled && rollBtn.style.display !== 'none') { rollDice(); return; }
      }
    });

    // ч╡Вф║ЖуГвуГ╝уГАуГл
    function showQuitConfirm() { document.getElementById('quitModal').style.display = 'flex'; }
    function closeQuitConfirm() { document.getElementById('quitModal').style.display = 'none'; }

    function quitGame() {
      currentPlayer = 1;
      players = {
        1: { position: 0, cards: [], shields: 0, skipTurn: false, name: "" },
        2: { position: 0, cards: [], shields: 0, skipTurn: false, name: "" }
      };
      gameEnded = false;
      diceValue = 0;
      isAIGame = false;
      playerCount = 2;
      turnLocked = false;
      pendingAnswerFor = null;
      lucky6Active = false;
      isClosingCardPopup = false;
      isSwitchingTurn = false;
      turnId = 0;

      document.getElementById('quitModal').style.display = 'none';
      document.getElementById('questionModal').style.display = 'none';
      document.getElementById('cardModal').style.display = 'none';
      document.getElementById('cardPopup').style.display = 'none';
      document.getElementById('cardUsePopup').style.display = 'none';
      document.getElementById('shieldPopup').style.display = 'none';
      document.getElementById('answerPopup').style.display = 'none';
      document.getElementById('winnerModal').style.display = 'none';

      document.getElementById('gameContainer').style.display = 'none';
      document.getElementById('instructionsScreen').style.display = 'none';
      document.getElementById('setupScreen').style.display = 'flex';

      document.getElementById('player1Name').value = 'уГЧуГмуВдуГдуГ╝1';
      document.getElementById('player2Name').value = 'уГЧуГмуВдуГдуГ╝2';
      document.getElementById('playerCountSelect').value = '2';
      document.getElementById('gradeSelect').value = '4';
      togglePlayer2Input();
    }

    function closeAllPopups() {
      ['questionModal','cardModal','cardPopup','shieldPopup','answerPopup','winnerModal','quitModal','cardUsePopup','firstPlayerModal']
        .forEach(id => { const el = document.getElementById(id); if (el) el.style.display = 'none'; });
    }

    // шинхоЪф┐ЭхнШ/шкнуБ┐ш╛╝уБ┐
    function saveSettings(){
      try {
        localStorage.setItem('kanjiSugorokuSettings', JSON.stringify({
          p1: players[1].name, p2: players[2].name, grade: selectedGrade, isAIGame: isAIGame
        }));
      } catch(e) { console.warn('шинхоЪф┐ЭхнШуБлхд▒цХЧ:', e); }
    }
    function loadSettings(){
      try{
        const s = JSON.parse(localStorage.getItem('kanjiSugorokuSettings'));
        if(!s) return;
        document.getElementById('player1Name').value = s.p1 || 'уГЧуГмуВдуГдуГ╝1';
        document.getElementById('player2Name').value = s.p2 || 'уГЧуГмуВдуГдуГ╝2';
        document.getElementById('gradeSelect').value = String(s.grade || 4);
        document.getElementById('playerCountSelect').value = s.isAIGame ? '1' : '2';
        togglePlayer2Input();
      }catch(e){ console.warn('шинхоЪшкнуБ┐ш╛╝уБ┐уБлхд▒цХЧ:', e); }
    }

    // уГвуГ╝уГАуГлуГжуГ╝уГЖуВгуГкуГЖуВг
    function openModal(id, focusSelector) {
      const el = document.getElementById(id);
      if (!el) return;
      el.style.display = 'flex';
      if (focusSelector) {
        requestAnimationFrame(() => {
          const f = document.querySelector(focusSelector);
          if (f && typeof f.focus === 'function') f.focus();
        });
      }
    }
    function closeModal(id) {
      const el = document.getElementById(id);
      if (!el) return;
      el.style.display = 'none';
    }

    // цЬАхИЭуБлчЫдщЭвуБауБСчФицДПя╝ИшГМщЭвя╝Й
    initializeBoard();
  </script>

  <!-- я╝ИуБЭуБоуБ╛уБ╛цоЛуБЧя╝ЙCloudflare уБоуВ╣уГЛуГЪуГГуГИ -->
  <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'970a8fe3f3c219c9',t:'MTc1NTQ0ODI5MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>
